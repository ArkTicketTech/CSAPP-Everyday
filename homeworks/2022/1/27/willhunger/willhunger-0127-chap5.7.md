# Ch5 Optimizing Program Performance

## 5.7 Understanding Modern Processors

**5.7.1 Overall Operation**

现代微处理器都增加了 ALU 功能单元的数量以及每个单元能执行的操作组合，提升了各个单元的性能。书中例举的 Intel Core i7 Haswell 中的功能单元中在存储操作中继承了加载和地址运算两个功能单元，分别用于计算存储单元和实际保存数据。

ICU 中，retirement unit 记录正在进行的处理，确保其遵守机器级程序的顺序语义。retirement unit 包含了一个寄存器文件(包含了整数、浮点数等寄存器)，其控制这些寄存器的更新。指令译码时，指令的信息会被放到一个先进先出的队列中。如果指令执行完成且分支预测正确，则这条指令对程序寄存器的更新可以被实际执行；如果执行发生分支预测错误，则会清空这条指令并丢弃这条指令计算出来的结果，保证了分支预测错误不会改变程序的状态。

此外，EU 的各个执行单元的执行结果是可以交换的，加速了指令间的传送，比流水线数据转发技术更为精细。书上介绍了寄存器重命名（register renaming）这一机制实现该方法。

