程序在系统中执行的过程

- 系统的硬件组成

	1. 总线

		系统各个方面的数据传递，类似于计算机中高速公路。通常总线被设计成传送定长的字节块，也就是字。字是系统的基本参数之一。一个字要么是 4 字节，要么是 8 字节，对应着 32 位操作系统和 64 位操作系统。

	2. `io` 设备

		系统和外界交互的设备，`i(input)/o(output)）`，这里的输入输出就是数据流动的方向，`input` 就是输入，`output` 就是输出 。

		这里要注意概念的场景，通常系统 `io` 的方向就是指的是数据流动的方向，但是在一些参考资料中的 `io` 可能是相对于目标设备，这个要注意。

		`io` 设备可能无法直接和总线进行连接通信，需要通过控制器或者适配器和总线进行连接

	3. 主存（内存）

		主存是一个临时存储设备，在处理器执行程序时，用来存放程序和程序处理的数据。

		是一组线性的字节数组，每个字节都有唯一的地址，也就是这个数组的索引

	4. 中央处理器`(cpu)`

		解释或者执行存储在主存中的指令的引擎。

		处理器的核心是一个大小为一个字的存储设备（寄存器），这就是程序计数器`(PC)`。`PC` 指向主存中存储某条机器指令的位置，`PC` 存储某条指令的地址，所以`PC` 的大小为一个字。

		从系统通电开始，知道系统断电，处理器一直在不断的执行`PC` 指向的指令。这里的指令就是`CPU` 指令集模型架构中包含的指令。

		寄存器文件 `Register file` 是一个小型的存储设备，由一些单个字长的存储器组成。`ALU` （算数逻辑单元） 计算新的数据和地址值。

		`cpu` 常见的操作

		- 加载：从主存复制一个字节或者一个字到寄存器。
		- 存储：从寄存器复制一个字节或者一个字到主存中。
		- 操作：把两个寄存器的内容复制到 `ALU`中，`ALU` 对两个内容进行逻辑运算，并且将结果放到寄存器中。
		- 跳转：从指令本身中抽出一个字，并将这个字复制到程序计数器中。

		

	![image-20230422230918257](https://typra-pictures.oss-cn-beijing.aliyuncs.com/imgs/image-20230422230918257.png)

- 一个简单 `hello` 程序在系统中执行的过程

	1. 用户从 键盘输入`shell`，不考虑屏幕显示的情况下。
		1. 用户从键盘输入`hello`，`hello` 经过`usb` 控制进行总线
		2. 通过总线穿过 `io` 桥，通过总线接口 存储到 `cpu` 寄存器文件中。
		3. 然后这个命令再次通过总线 存储到内存中。
	2. 执行这条命令
		1. 数据从磁盘加载到主存中。
	3. 当数据加载到内存执行
		1. `cpu`就一步步执行 `main`中指令
		2. 同样再从指定位置输出出来