高速缓存采用不同的方式组织存储块,以实现在成本与灵活性之间的平衡。

主要的组织方式有:

1. 集体关联(Fully Associative):

   集体关联将缓存划分为许多相同大小的块,每个块可以存放任意位置主存地址的数据。这种组织提供最大的灵活性,可以随意选择哪个块存储新数据,实现最佳的空间利用率。

   但是,它需要额外的标签和块号管理信息来确定数据与存储块的对应关系,实现复杂且成本高。所以,仅在需要极高灵活性的场景使用,如TLB。

2. 直接映射(Direct Mapped):

   直接映射将主存地址空间和缓存空间划分为相同数量的块,每个主存块只能对应缓存的一个块。这种组织成本最低,只需要 part of address来索引缓存,速度最快。

   但是,它不灵活,相邻的主存地址可能映射到非相邻的缓存块,无法优化空间局部性,在某些地址分布下性能较差。所以,仅在对性能要求不高但成本敏感的场合使用。

3.  n路组相联(n-way Set Associative):

   n路组相联将主存地址空间划分为多个集合,每个集合包含n个缓存块。主存地址只对应集合,在集合内灵活选择任一块存储数据。这种组织在成本与灵活性之间取得平衡,是高速缓存常用的组织形式。

   常用的n路组相联方式有2路相联、4路相联和8路相联。n越大,灵活性越高,但也需要更多的标签与索引来管理,实现难度增大。所以,需要在性能要求与实现成本之间进行权衡。